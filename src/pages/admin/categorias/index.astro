---
import CMSLayout from "@/layouts/CMSLayout.astro";
import { createClient } from "@/lib/supabase";
import { getAllCategoriesWithSubcategories } from "@/lib/data/admin";
import CategoriesManager from "@/components/admin/CategoriesManager";

const supabase = createClient({
  request: Astro.request,
  cookies: Astro.cookies,
});
const categories = await getAllCategoriesWithSubcategories(supabase);
---

<CMSLayout
  title="Categorías - ARM Admin"
  description="Gestión de categorías ARM"
>
  <div class="categories-page">
    <header class="page-header">
      <div class="header-content">
        <h1 class="page-title">Categorías y Subcategorías</h1>
        <p class="page-subtitle">
          Gestiona la estructura de tu catálogo de productos
        </p>
      </div>
    </header>

    <CategoriesManager client:load initialCategories={categories} />
  </div>
</CMSLayout>

<style>
  .categories-page {
    max-width: 1200px;
    margin: 0 auto;
  }

  .page-header {
    margin-bottom: 1.5rem;
  }

  .page-title {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--admin-text);
    margin: 0 0 0.25rem;
  }

  .page-subtitle {
    font-size: 0.9375rem;
    color: var(--admin-text-muted);
    margin: 0;
  }

  @media (max-width: 768px) {
    .page-title {
      font-size: 1.5rem;
    }
  }
</style>
